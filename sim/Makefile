OBJS = main.o
OBJS += $(addprefix ../src/, freqcounter.o)
OBJS += $(addprefix ../common/, sim_pin.o sim_timer.o intmath.o)
OBJS += $(addprefix icemu/capi/, icemu.o)

TO_CLEAN = $(OBJS) $(PROGNAME) seg7multiplex

SUBMODULE_TARGETS = ../common/README.md

ALL = $(SUBMODULE_TARGETS) $(PROGNAME) seg7multiplex

include ../common.mk

CFLAGS = -I. -DSIMULATION $(COMMON_CFLAGS) -c
LDFLAGS = -I.

# Rules
$(PROGNAME): $(OBJS)
	$(CC) $(LDFLAGS) $+ -o $@

seg7multiplex: $(SUBMODULE_TARGETS)
	MAX_DIGITS=4 make -C ../seg7-multiplex/sim clean all
	cp ../seg7-multiplex/sim/seg7multiplex .

